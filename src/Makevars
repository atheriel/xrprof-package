R_HEADERS := `"$(R_HOME)/bin$(R_ARCH_BIN)/R" CMD config --cppflags`
$(SHLIB): ../inst/vendor/xrprof

../inst/vendor/xrprof: vendor/xrprof
	mkdir -p ../inst/vendor
	cp vendor/xrprof ../inst/vendor/xrprof

vendor/xrprof:
	cd vendor && $(MAKE) xrprof CC="$(CC)" CFLAGS="$(CFLAGS) $(CPICFLAGS) $(R_HEADERS)" AR="$(AR)" RANLIB="$(RANLIB)"

clean:
	cd vendor && $(MAKE) clean
